{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es6.array.find-index.js","webpack:///./src/views/Lyric.vue?c444","webpack:///./src/views/Lyric.vue?d2b1","webpack:///src/views/Lyric.vue","webpack:///./src/views/Lyric.vue?f7fe","webpack:///./src/views/Lyric.vue"],"names":["$export","$find","KEY","forced","Array","P","F","findIndex","callbackfn","this","arguments","length","undefined","render","_vm","_h","$createElement","_c","_self","class","show","grab","on","$event","changeGrab","moveLyric","playNow","staticClass","style","top","_l","item","index","lyricIndex","domProps","_s","str","trans","_e","directives","name","rawName","value","protect","current","expression","playAtCenter","_v","formatTooltip","centerTime","staticRenderFns","component"],"mappings":"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","file":"js/chunk-ca0fd61c.da98258a.js","sourcesContent":["'use strict';\n// 22.1.3.9 Array.prototype.findIndex(predicate, thisArg = undefined)\nvar $export = require('./_export');\nvar $find = require('./_array-methods')(6);\nvar KEY = 'findIndex';\nvar forced = true;\n// Shouldn't skip holes\nif (KEY in []) Array(1)[KEY](function () { forced = false; });\n$export($export.P + $export.F * forced, 'Array', {\n  findIndex: function findIndex(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\nrequire('./_add-to-unscopables')(KEY);\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Lyric.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Lyric.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:(\"lyric-content-container \" + (_vm.show && 'show'))},[_c('div',{class:(\"lyric-list-container \" + (_vm.grab ? 'grabbing' : '')),on:{\"mousedown\":function($event){return _vm.changeGrab(true)},\"mouseup\":function($event){return _vm.changeGrab(false)},\"mouseleave\":function($event){return _vm.changeGrab(false)},\"mousemove\":_vm.moveLyric}},[(_vm.playNow.lyric)?_c('div',{staticClass:\"lyric-list\",style:((\"top: \" + _vm.top + \"px;\"))},_vm._l((_vm.playNow.lyric),function(item,index){return _c('div',{class:(\"lyric-item lyric-item-\" + index + \" \" + (index === _vm.lyricIndex ? 'lyric-item-now' : ''))},[_c('div',{domProps:{\"innerHTML\":_vm._s(item.str || '')}}),(item.trans)?_c('div',{domProps:{\"innerHTML\":_vm._s(item.trans)}}):_vm._e()])}),0):_vm._e()]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.protect > 0 && _vm.protect >= (_vm.current - 3000) || _vm.grab),expression:\"protect > 0 && protect >= (current - 3000) || grab\"}],staticClass:\"play-line-center\"},[_c('hr'),_c('div',{staticClass:\"p-time-btn\",on:{\"mouseover\":function($event){return _vm.changeGrab(true)},\"mouseleave\":function($event){return _vm.changeGrab(false)},\"click\":_vm.playAtCenter}},[_vm._v(\"\\n      \"+_vm._s(_vm.formatTooltip(_vm.centerTime))+\"\\n      \"),_c('i',{staticClass:\"iconfont icon-play\"})])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div :class=\"`lyric-content-container ${show && 'show'}`\">\n    <div\n      :class=\"`lyric-list-container ${grab ? 'grabbing' : ''}`\"\n      @mousedown=\"changeGrab(true)\"\n      @mouseup=\"changeGrab(false)\"\n      @mouseleave=\"changeGrab(false)\"\n      @mousemove=\"moveLyric\"\n    >\n      <div v-if=\"playNow.lyric\" class=\"lyric-list\" :style=\"`top: ${top}px;`\">\n        <div v-for=\"(item, index) in playNow.lyric\" :class=\"`lyric-item lyric-item-${index} ${index === lyricIndex ? 'lyric-item-now' : ''}`\">\n          <div v-html=\"item.str || ''\"></div>\n          <div v-if=\"item.trans\" v-html=\"item.trans\"></div>\n        </div>\n      </div>\n    </div>\n    <div class=\"play-line-center\" v-show=\"protect > 0 && protect >= (current - 3000) || grab\">\n      <hr />\n      <div\n        class=\"p-time-btn\"\n        @mouseover=\"changeGrab(true)\"\n        @mouseleave=\"changeGrab(false)\"\n        @click=\"playAtCenter\"\n      >\n        {{formatTooltip(centerTime)}}\n        <i class=\"iconfont icon-play\" />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n  import { mapGetters } from 'vuex';\n  import Num from \"../assets/utils/num\";\n  export default {\n    name: \"Lyric\",\n    data() {\n      return {\n        lyricIndex: 0,\n        top: 600,\n        grab: false,\n        mouseY: 0,\n        mouseTop: 0,\n        mouseMove: 0,\n        protect: 0, // 保护期，滚完之后给一个保护期，不过这个保护期就不自动滚动歌词\n        show: false,\n        centerTime: 0,\n        current: 0,\n      }\n    },\n    computed: {\n      ...mapGetters({\n        playNow: 'getPlaying',\n        percent: 'getPlayingPercent',\n      })\n    },\n    watch: {\n      playNow({ lyricKeys = []}) {\n        this.protect = 0;\n        this.top = document.getElementsByClassName('lyric-content-container')[0].clientHeight / 2 - 35;\n        this.mouseTop = 0;\n        this.grab = false;\n        this.lyricIndex = lyricKeys[0];\n        this.mouseY = 0;\n      },\n      percent() {\n        const { playNow } = this;\n        const { lyric } = playNow;\n        if (!lyric) {\n          return;\n        }\n        const lyricKeys = Object.keys(lyric);\n        const current = document.getElementById('m-player').currentTime * 1000;\n        const carouselHeight = document.getElementsByClassName('lyric-content-container')[0].clientHeight;\n        const key = lyricKeys.findIndex((k) => (k - 300) >= current);\n        const nowDom = document.getElementsByClassName('lyric-item-now');\n        this.current = current;\n        let lyricKey = current;\n        switch (key) {\n          case -1:\n            lyricKey = lyricKeys[lyricKeys.length - 1] || current;\n            break;\n          case 0:\n            lyricKey = lyricKeys[0];\n            break;\n          default:\n            lyricKey = lyricKeys[key-1];\n        }\n        this.lyricIndex = lyricKey;\n\n        if (this.protect && (this.protect >= (current - 3000))) {\n          return;\n        }\n        this.protect = 0;\n        if (nowDom && nowDom[0] && !this.grab) {\n          this.top = carouselHeight / 2 - nowDom[0].offsetTop - 35;\n        }\n      },\n      top(v) {\n        const { playNow } = this;\n        const domC = document.getElementsByClassName('lyric-content-container')[0];\n        (Object.keys(playNow.lyric || {})).forEach((o, i) => {\n          const domL = document.getElementsByClassName(`lyric-item-${o}`)[0];\n          if (domL) {\n            const { offsetHeight, offsetTop } = domL;\n            let h = offsetTop + v - domC.offsetHeight / 2;\n            if (h < 0 && offsetHeight + h > 0) {\n              this.centerTime = Number(o / 1000);\n            }\n          }\n        })\n\n      }\n    },\n    created() {\n      setTimeout(() => this.show = true);\n    },\n    methods: {\n      // 鼠标时点击还是抬起\n      changeGrab(v) {\n        if (this.grab === v) {\n          return;\n        }\n        this.grab = v;\n        const event = window.event;\n        const mouseY = event.clientY;\n        // 点下的情况\n        if (this.grab) {\n          this.mouseY = mouseY;\n          this.mouseTop = this.top;\n        } else {\n          //  松开或者鼠标已经移出去\n          this.top += this.mouseMove;\n          this.mouseMove = 0;\n          this.protect = document.getElementById('m-player').currentTime * 1000;\n        }\n      },\n\n      // 移动歌词\n      moveLyric(e) {\n        if (this.grab) {\n          const event = e || window.event;\n          const mouseY = event.clientY;\n          this.top = this.mouseTop + mouseY - this.mouseY;\n        }\n      },\n\n      formatTooltip(v) {\n        return `${Num(v / 60, 0, -1)}:${Num(v % 60, 0) < 10 ? `0${Num(v % 60, 0)}` : Num(v % 60, 0)}`;\n      },\n      playAtCenter() {\n        const pDom = document.getElementById('m-player');\n        pDom.currentTime = this.centerTime;\n        this.grab = false;\n        setTimeout(() => this.protect = 0, 200);\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\">\n  .mode-mobile .lyric-content-container {\n    width: 100vw !important;\n    height: calc(100vh - 30vw) !important;\n    left: 0 !important;\n    top: 15vh !important;\n\n    .lyric-list {\n      width: calc(100vh - 30vw) !important;\n\n      .lyric-item {\n        font-size: 3.5vw !important;\n        padding: 0.5vw !important;\n        min-height: 0 !important;\n\n        &.lyric-item-now {\n          font-size: 4vw !important;\n        }\n      }\n    }\n  }\n\n  .lyric-content-container {\n    height: calc(100% - 50px);\n    overflow: hidden;\n    position: absolute;\n    left: 60%;\n    width: 40%;\n    opacity: 0;\n    transition: 1s;\n\n    &.show {\n      opacity: 1;\n    }\n\n    .lyric-list-container {\n      cursor: grab;\n\n      &.grabbing {\n        cursor: grabbing;\n\n        .lyric-list {\n          transition: 0s !important;\n        }\n      }\n\n      .lyric-list {\n        height: calc(100vh - 200px);\n        position: absolute;\n        width: 100%;\n        transition: 0.3s top;\n      }\n      .lyric-item {\n        color: rgba(255,255,255,0.5);\n        text-align: center;\n        font-size: 18px;\n        padding: 10px 0;\n        transition: 0.5s;\n        min-height: 15px;\n        line-height: 30px;\n\n        &.lyric-item-now {\n          color: rgba(255,255,255,0.8);\n          font-size: 22px;\n        }\n      }\n    }\n  }\n\n  .play-line-center {\n    position: absolute;\n    top: 50%;\n    width: 100%;\n    height: 0;\n    hr {\n      border: 1px dashed #fff6;\n      position: absolute;\n      z-index: -1;\n      width: 60%;\n      left: 15%;\n    }\n    .p-time-btn {\n      color: #fff6;\n      position: absolute;\n      right: 10%;\n      bottom: -11px;\n      cursor: pointer;\n      opacity: 0.7;\n      transition: 0.3s;\n\n      &:hover {\n        opacity: 1;\n      }\n    }\n  }\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Lyric.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Lyric.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Lyric.vue?vue&type=template&id=dac1aa4e&\"\nimport script from \"./Lyric.vue?vue&type=script&lang=js&\"\nexport * from \"./Lyric.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Lyric.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}